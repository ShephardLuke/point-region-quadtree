(()=>{"use strict";var t={208:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,"body {\n    margin: 0;\n}\n\n\ncanvas {\n    box-sizing: border-box;\n    border: 1px solid black;\n}\n\n/* .canvasInterface {\n    display:grid;\n}\n\n.canvasInterface canvas {\n    grid-column: 1;\n    grid-row: 1;\n} */",""]);const a=o},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var s="",i=void 0!==e[5];return e[4]&&(s+="@supports (".concat(e[4],") {")),e[2]&&(s+="@media ".concat(e[2]," {")),i&&(s+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),s+=t(e),i&&(s+="}"),e[2]&&(s+="}"),e[4]&&(s+="}"),s})).join("")},e.i=function(t,s,i,n,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(o[h]=!0)}for(var c=0;c<t.length;c++){var l=[].concat(t[c]);i&&o[l[0]]||(void 0!==r&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=r),s&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=s):l[2]=s),n&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=n):l[4]="".concat(n)),e.push(l))}},e}},601:t=>{t.exports=function(t){return t[1]}},72:t=>{var e=[];function s(t){for(var s=-1,i=0;i<e.length;i++)if(e[i].identifier===t){s=i;break}return s}function i(t,i){for(var r={},o=[],a=0;a<t.length;a++){var h=t[a],c=i.base?h[0]+i.base:h[0],l=r[c]||0,u="".concat(c," ").concat(l);r[c]=l+1;var d=s(u),p={css:h[1],media:h[2],sourceMap:h[3],supports:h[4],layer:h[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var w=n(p,i);i.byIndex=a,e.splice(a,0,{identifier:u,updater:w,references:1})}o.push(u)}return o}function n(t,e){var s=e.domAPI(e);return s.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;s.update(t=e)}else s.remove()}}t.exports=function(t,n){var r=i(t=t||[],n=n||{});return function(t){t=t||[];for(var o=0;o<r.length;o++){var a=s(r[o]);e[a].references--}for(var h=i(t,n),c=0;c<r.length;c++){var l=s(r[c]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}r=h}}},659:t=>{var e={};t.exports=function(t,s){var i=function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(t){s=null}e[t]=s}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(s)}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,s)=>{t.exports=function(t){var e=s.nc;e&&t.setAttribute("nonce",e)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(s){!function(t,e,s){var i="";s.supports&&(i+="@supports (".concat(s.supports,") {")),s.media&&(i+="@media ".concat(s.media," {"));var n=void 0!==s.layer;n&&(i+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),i+=s.css,n&&(i+="}"),s.media&&(i+="}"),s.supports&&(i+="}");var r=s.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,s)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var r=e[i]={id:i,exports:{}};return t[i](r,r.exports,s),r.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.nc=void 0;class i{constructor(){}}class n extends i{constructor(t,e,s,i=100){super(),this.red=t,this.green=e,this.blue=s,this.alpha=i}}class r extends n{constructor(t,e,s,i){super(t,e,s,i)}toFillStyle(){return"rgb("+this.red+" "+this.blue+" "+this.green+" / "+this.alpha+"%)"}draw(t){t.fillStyle=this.toFillStyle()}}const o={width:50*Math.floor((window.innerWidth-2)/50),height:50*Math.floor((window.innerHeight-60)/50),font:"25px arial",previewFill:new r(210,210,210,50)},a={stateRadius:50,autoName:!0},h={cellSize:50,showGrid:!0};let c=null;function l(){return c||(c=new u,c)}class u{constructor(){this.canvas=o,this.FSA=a,this.grid=h}}class d{static singleton=null;static getInstance(){return d.singleton||(d.singleton=new d,window.fps=d.singleton),d.singleton}constructor(){this.nativeFPS=0,this.canvasFPS=0,this.accurateFPS=0,this.accurateFPSCounter=0,this.canvasFPSLimit=-1,this.canvasTime=0,this.fps=10,this.currentFrame=0,this.requests=[],this.timeSinceLastFrame=0,this.lastTime=0,this.secondCounter=0,this.display=null,window.requestAnimationFrame(this.frame.bind(this))}frame(t){if(this.timeSinceLastFrame=t-this.lastTime,0===this.timeSinceLastFrame)return void window.requestAnimationFrame(this.frame.bind(this));this.lastTime=t,this.canvasTime+=this.timeSinceLastFrame,this.nativeFPS=1/this.timeSinceLastFrame*1e3,this.canvasFPS=this.canvasFPSLimit,-1===this.canvasFPSLimit&&(this.canvasFPS=this.nativeFPS);let e=1e3/this.canvasFPS;for(;this.canvasTime>=e;){if(this.secondCounter+=e,this.secondCounter>=1e3?(this.accurateFPS=this.accurateFPSCounter,this.accurateFPSCounter=1,this.refreshDisplay(),this.secondCounter=0):this.accurateFPSCounter+=1,this.requests.length>0){for(let t of this.requests)t.draw(this.canvasTime);this.requests=[]}this.canvasTime-=e}window.requestAnimationFrame(this.frame.bind(this))}canvasRequest(t){this.requests.includes(t)||this.requests.push(t)}setDisplay(t){this.display=t,this.refreshDisplay()}refreshDisplay(){this.display&&(this.display.element.innerText="Canvas FPS: "+Math.floor(this.accurateFPS))}}const p=Object.freeze({TOP_LEFT:Symbol("Top Left"),CENTRE:Symbol("Centre")});class w extends i{constructor(){super()}}class f extends w{static ZERO(){return new this(0,0)}constructor(t,e){super(),this.x=t,this.y=e}}class m extends i{constructor(t=null){super(),this.colour=t}draw(t){this.colour&&(t.fillStyle=this.colour.toFillStyle(),t.fill())}}class v{constructor(t=null){this.fill=new m(t)}}class g{constructor(t,e=f.ZERO(),s=new v){this.drawable=t,this.position=e,this.properties=s}draw(t){this.drawable.draw(t,this.position,this.properties,p.CENTRE)}}class b{constructor(t){this.FPSCalculator=d.getInstance(),this.setupConext(t),this.requests=[]}setupConext(t){this.context=t.element.getContext("2d")}drawRequest(t){t instanceof g?this.requests.push(t):console.error(t.constructor.name+" not instance of ObjectDrawer!")}refreshDisplay(){this.FPSCalculator.canvasRequest(this)}draw(t){for(let t of this.requests)t.draw(this.context);this.requests=[]}}class y extends w{constructor(t,e){super(),this.width=t,this.height=e}}class x extends y{constructor(t,e){super(t,e)}draw(t,e,s){t.beginPath(),t.rect(e.x,e.y,this.width,this.height),s.fill.draw(t),t.stroke()}}class S{constructor(t,e=-1){this.objectDrawer=t,this.perSecond=e,this.totalTime=0,this.lastTime=0}draw(t,e){if(-1===this.perSecond)this.objectDrawer.draw(t);else{let s=d.getInstance().canvasFPS;this.totalTime+=e;let i=1e3/this.perSecond;this.perSecond>Math.round(s)&&(i=this.perSecond/s*1e3,console.log(i)),Math.round(this.totalTime)>=i&&(this.objectDrawer.draw(t),this.totalTime=0)}}}class P extends b{constructor(t){super(t);let e=new x(t.element.width,t.element.height),s=new g(e,f.ZERO(),new v(new r(255,255,255)));this.clearDisplay=new S(s),this.drawRequest(this.clearDisplay),this.FPSCalculator.canvasRequest(this)}drawRequest(t){t.objectDrawer instanceof g?this.requests.push(t):console.error(t.objectDrawer.constructor.name+" not instance of ObjectDrawerFPS.ObjectDrawer!")}draw(t){for(let e of this.requests)e.draw(this.context,t)}}class R extends i{static BODY=new function(){return new R(document.body)};constructor(t,e=null){super(),this.element=t,this.display=e}insertElementInto(t=null){t&&t.element.appendChild(this.element)}insertElementBefore(t,e){t.insertBefore(this.element,e)}}class C extends R{constructor(t,e=null){super(document.createElement("canvas"),t),this.parentElement=e,this.setup()}setup(){this.setupElement(),this.insertElementInto(this.parentElement)}setupElement(){let t=l().canvas;this.element.width=t.width,this.element.height=t.height,this.setupDrawHandler()}setupDrawHandler(){this.drawHandler=new b(this)}createEventListener(t,e){this.element.addEventListener(t,e)}getRect(){return new y(this.element.width,this.element.height)}}class L{constructor(t,e){this.position=t,this.rect=e,this.objects=[]}}class F extends L{constructor(t){super(t),this.drawableRect=new x(t.width,t.height)}draw(t,e,s){this.drawableRect.draw(t,e,s)}}class q{constructor(t,e){this.rect=t,this.cellSize=e,this.setupGrid()}setupGrid(){this.cells=[];for(let t=0;t<this.rect.height;t+=this.cellSize){let t=[];for(let e=0;e<this.rect.width;e+=this.cellSize)this.addCell(t,new y(this.cellSize,this.cellSize));this.cells.push(t)}}addCell(t,e){t.push(new L(e))}}class E extends q{constructor(t,e){super(t,e)}draw(t,e,s){for(let e=0;e<this.cells.length;e++)for(let i=0;i<this.cells[e].length;i++)this.cells[e][i].draw(t,new f(i*this.cellSize,e*this.cellSize),s)}addCell(t,e){t.push(new F(e))}}class D extends C{constructor(t,e=null){super(t,e)}draw(t,e,s){t.drawImage(this.element,e.x,e.y)}}class k{constructor(t){this.canvas=t,this.grid=new E(this.canvas.getRect(),l().grid.cellSize);let e=new D(null);new g(e),e.drawHandler.drawRequest(new g(this.grid)),l().grid.showGrid}checkCollision(t){}checkDrawableCollision(t){let e=structuredClone(this.quadTree);console.log(e.addObject(t))}addToWorld(t){console.log(getBoundingRect)}}class T extends C{constructor(t,e=null,s=!1,i=!1){super(t,e),this.createEventListeners(s,i),this.setupCollisionHandler()}createEventListeners(t,e){t&&this.element.addEventListener("click",this.onClick.bind(this)),e&&this.element.addEventListener("mousemove",this.onMouseMove.bind(this))}setupCollisionHandler(){this.collisionHandler=new k(this)}setupDrawHandler(){this.drawHandler=new P(this)}onClick(t){let e=this.getMousePosition(t);this.display.mode.onClick(e)}onMouseMove(t){let e=this.getMousePosition(t);this.display.mode.onMouseMove(e)}getMousePosition(t){const e=this.element.getBoundingClientRect();let s=t.clientX-e.left,i=t.clientY-e.top;return new f(s,i)}}class O extends R{constructor(t){super(document.createElement("div")),this.insertElementInto(t)}}class j{constructor(t,e){this.name=t,this.name.text=this.name.text+" Display",this.divElement=new O(R.BODY),this.canvas=new T(this,this.divElement,!0,!0),this.mode=new e(this),this.displayName()}displayName(){this.canvas.drawHandler.drawRequest(new S(new g(this.name,new f(this.canvas.element.width/2,30))))}}class M{constructor(t,e){this.display=t,this.structure=e}switchMode(t){this.onEnd();let e=new t(this.display,this.structure);return e.onStart(),e}onStart(){}onClick(t,e){}onEnd(){}}class A extends M{constructor(t,e){super(t,e)}onClick(t,e){}onMouseMove(t,e){}draw(t){t.draw(this.display.canvas.context,this.display.canvas.drawHandler.FPSCalculator)}}class H extends i{constructor(t){super(),this.text=t}}class z extends H{constructor(t){super(t)}draw(t,e,s){t.font=l().canvas.font,t.textAlign="center",t.beginPath(),t.fillStyle="black";let i=new f(e.x,e.y+parseInt(l().canvas.font)/4);t.fillText(this.text,i.x,i.y)}}var I=s(72),Q=s.n(I),N=s(825),B=s.n(N),G=s(659),Z=s.n(G),_=s(56),Y=s.n(_),U=s(540),W=s.n(U),J=s(113),X=s.n(J),K=s(208),V={};V.styleTagTransform=X(),V.setAttributes=Y(),V.insert=Z().bind(null,"head"),V.domAPI=B(),V.insertStyleElement=W(),Q()(K.A,V),K.A&&K.A.locals&&K.A.locals;class ${constructor(t,e=f.ZERO()){this.bucket=[],this.position=e,this.bucket=null,this.rect=t,this.topLeft=null,this.topRight=null,this.bottomLeft=null,this.bottomRight=null}}class tt extends ${constructor(t,e=f.ZERO()){super(t,e)}addObject(t){return this.topLeft?this.insertObjectintoQuadrant(t):this.bucket?(obj.position.x!=t.position.x||obj.position.y!=t.position.y)&&(this.split(),this.insertObjectintoQuadrant(obj),this.bucket=[],this.insertObjectintoQuadrant(t),this):(this.bucket=t,null)}split(){let t=new Rect(this.rect.width/2,this.rect.height/2);this.topLeft=new $(t,this.position),this.topRight=new $(t,new f(this.position.x+t.width,this.position.y)),this.bottomLeft=new $(t,new f(this.position.x,this.position.y+t.height)),this.bottomRight=new $(t,new f(this.position.x+t.width,this.position.y+t.height))}insertObjectintoQuadrant(t){let e=t.position,s=this.getQuadrantAtPosition(e);return s?s.addObject(t):s}getQuadrantAtPosition(t){if(t.y<this.bottomLeft.position.y){if(t.x<this.topRight.position.x)return this.topLeft;if(t.x<this.topRight.position.x+this.topRight.rect.width)return this.topRight}else if(t.y<this.bottomLeft.position.y+this.bottomLeft.rect.height)return t.x<this.bottomLeft.position.x+this.bottomLeft.rect.width?this.bottomLeft:this.bottomRight;return!1}getRegionAtPosition(t){if(!this.topLeft)return this;let e=this.getQuadrantAtPosition(t);return!!e&&e.getRegionAtPosition(t)}}class et extends tt{constructor(t,e=1,s=f.ZERO()){super(t,s),this.bucket=[],this.bucketSize=e}addObject(t){if(this.topLeft)return this.insertObjectAtQuadrant(t);if(this.bucket.length<this.bucketSize)return this.bucket.push(t),null;for(let e of this.bucket){if(e.x==t.x&&e.y==t.y)return!1;this.topLeft||this.split(),this.insertObjectAtQuadrant(e)}return this.bucket=[],this.insertObjectAtQuadrant(t),this}split(){let t=new y(this.rect.width/2,this.rect.height/2);this.topLeft=new $(t,this.position,this.bucketSize),this.topRight=new $(t,new f(this.position.x+t.width,this.position.y),this.bucketSize),this.bottomLeft=new $(t,new f(this.position.x,this.position.y+t.height),this.bucketSize),this.bottomRight=new $(t,new f(this.position.x+t.width,this.position.y+t.height),this.bucketSize)}insertObjectAtQuadrant(t){let e=this.getQuadrantAtPosition(t);return e?e.addObject(t):e}}class st extends et{constructor(t,e,s=1){super(e,s,t),this.createRect()}split(){let t=new y(this.rect.width/2,this.rect.height/2);this.topLeft=new st(this.position,t,this.bucketSize),this.topRight=new st(new f(this.position.x+t.width,this.position.y),t,this.bucketSize),this.bottomLeft=new st(new f(this.position.x,this.position.y+t.height),t,this.bucketSize),this.bottomRight=new st(new f(this.position.x+t.width,this.position.y+t.height),t,this.bucketSize)}createRect(){this.rectDrawable=new x(this.rect.width,this.rect.height)}draw(t,e,s){this.rectDrawable.draw(t,e,s),this.topLeft&&(this.topLeft.draw(t,e,s),this.topRight.draw(t,new f(e.x+this.rect.width/2,e.y),s),this.bottomLeft.draw(t,new f(e.x,e.y+this.rect.height/2),s),this.bottomRight.draw(t,new f(e.x+this.rect.width/2,e.y+this.rect.height/2),s))}}class it extends A{constructor(t,e=null){super(t,e),this.structure=new st(new f(0,0),this.display.canvas.getRect())}}class nt extends f{constructor(t,e){super(t,e)}draw(t,e,s){t.beginPath(),t.arc(e.x,e.y,5,0,2*Math.PI),s.fill.draw(t),t.stroke()}}class rt extends it{onStart(){let t=l().canvas;this.quadrantPreview=new g(new x(1,1),new f(-100,-100),new v(t.previewFill)),this.pointDrawer=new g(new nt(-100,-100),new f(-100,-100),new v(t.previewFill)),this.display.canvas.drawHandler.drawRequest(new S(new g(this.display.quadtreeCanvas))),this.display.canvas.drawHandler.drawRequest(new S(this.quadrantPreview)),this.display.canvas.drawHandler.drawRequest(new S(this.pointDrawer))}onMouseMove(t){this.pointDrawer.drawable.x=t.x,this.pointDrawer.drawable.y=t.y,this.pointDrawer.position.x=t.x,this.pointDrawer.position.y=t.y;let e=this.structure.getRegionAtPosition(t);e&&this.setPreviewQuardrant(e),this.display.canvas.drawHandler.refreshDisplay()}onClick(t){let e=new nt(t.x,t.y),s=this.structure.addObject(e);s&&this.display.quadtreeCanvas.drawHandler.drawRequest(new g(s,new f(s.position.x,s.position.y))),!1!==s&&this.display.quadtreeCanvas.drawHandler.drawRequest(new g(e,t));let i=this.structure.getRegionAtPosition(t);i&&this.setPreviewQuardrant(i),this.display.quadtreeCanvas.drawHandler.refreshDisplay(),this.display.canvas.drawHandler.refreshDisplay()}setPreviewQuardrant(t){this.quadrantPreview.drawable.width=t.rect.width,this.quadrantPreview.drawable.height=t.rect.height,this.quadrantPreview.position=t.position}}window.GLOBAL_SETTINGS=new l;let ot=new class extends R{constructor(t=""){super(document.createElement("p")),this.element.innerHTML=t}};document.body.appendChild(ot.element),d.getInstance().setDisplay(ot),new class extends j{constructor(){super(new z("Quadtree (Point-region)"),it),this.mode=this.mode.switchMode(it),this.quadtreeCanvas=new D(this),this.mode=this.mode.switchMode(rt)}}})();